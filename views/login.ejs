
<%- include('partials/header') %>  

<link rel="stylesheet" href="stylesheets/login.css">



<div class="login-form ">
	<ul class="nav nav-pills nav-justified tabs">
		<li class="tab" ><a data-toggle="pill" href="#login">Login</a></li>
		<li class="tab active"> <a data-toggle="pill" href="#register" >Register</a> </li>
	</ul>

	<div class="tab-content">
		<div id="login" class="tab-pane fade in">
			<form class=" form-signin">
				<h1 class="h3 mb-3 font-weight-normal">Sign in</h1>
				<label for="inputEmail" class="sr-only">Email address</label>
				<input type="email" name="username" id="inputEmail" class="form-control" placeholder="Email address" required="" autofocus="">
				<label for="inputPassword" class="sr-only">Password</label>
				<input type="password" name="password" id="inputPassword" class="form-control confirm-pass" placeholder="Password" required="">
				<button class="btn btn-lg btn-primary btn-block" onclick="handleClick(event)" name="btnLogin" type="submit">Sign In</button>
				<div id='errLogin' style="display: none;" class="err-registered">Invalid Credentials!</div>
				<p class="mt-5 mb-3 text-muted"></p>
			</form>
			</div>
		
			<div id="register" class="tab-pane fade in active" >
			<form action="/register" method="POST" class="form-signin">
				<h1 class="h3 mb-3 font-weight-normal">Sign Up</h1>
				<label for="inputEmail" class="sr-only">Email address</label>
				<input type="email" name="username" id="inputRegEmail" class="form-control" placeholder="Email address" required="" autofocus="">
				<label for="inputPassword" class="sr-only">Password</label>
				<input type="password" name="password" id="inputRegPassword" class="form-control" placeholder="Password" required="">
				<label for="inputConfirmPassword" class="sr-only">Confirm Password</label>
				<input type="password" id="inputConfirmPassword" class="form-control confirm-pass" placeholder="Confirm Password" required="">
				
				<button class="btn btn-lg btn-primary btn-block" onclick="handleClick(event)" name="btnRegister" type="submit">Sign Up</button>
				<div id='errDiffPass' style="display: none;" class="err-registered">Password DO NOT MATCH</div>
				<div id='errRegd' style="display: none;" class="err-registered">User Already Registered</div>

			</form>
			</div>
			

	</div>
	

</div>


<script>
	function handleClick(event){
		event.preventDefault();
			
		if(event.target.name == "btnLogin"){
			const user = {
		  	username: $("#inputEmail").val(),
		  	password: $("#inputPassword").val()
		  }
			var xhttp = new XMLHttpRequest();
    	xhttp.onreadystatechange = function() {
        if (this.readyState == 4 ) {
					if( this.status == 401){
						$("#errLogin").css("display", "block");
					} else if(this.status ==200) {
						window.location.href = "/home";
					}
       }
    	};
			xhttp.open("POST", "/login");
			xhttp.setRequestHeader("Content-type", "application/json");
    	xhttp.send(JSON.stringify(user));
		}

		else {
			const user = {
		  	username: $("#inputRegEmail").val(),
		  	password: $("#inputRegPassword").val()
			}
			if($('#inputRegPassword').val() == $('#inputConfirmPassword').val()){
				var xhttp = new XMLHttpRequest();
    		xhttp.onreadystatechange = function() {
        	if (this.readyState == 4) {
						if(this.status == 401){
							$("#errRegd").css("display", "block");
						} else if(this.status == 200){
							window.location.href = "/home";
						}
       		}
    		};
				xhttp.open("POST", "/register");
				xhttp.setRequestHeader("Content-type", "application/json");
    		xhttp.send(JSON.stringify(user));
			} else {
				$('#errDiffPass').css("display", "block");
				$('#inputRegPassword').focus();
			}			
		}
	}


</script>


		
<%- include('partials/footer') %> 